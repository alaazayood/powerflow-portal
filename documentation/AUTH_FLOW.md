# ุชุฏูู ุงููุตุงุฏูุฉ (Authentication Flow)

ูุดุฑุญ ูุฐุง ุงููุณุชูุฏ ููููุฉ ุนูู ูุธุงู ุงููุตุงุฏูุฉ ูู PowerFlow Portalุ ุจุฏุกุงู ูู ุงูุชุณุฌูู ูุญุชู ุงููุตูู ุงูุขูู.

## ๐ ุฏูุฑุฉ ุญูุงุฉ ุงููุณุชุฎุฏู (User Lifecycle)

### 1. ุงูุชุณุฌูู (Registration)
1. ูููู ุงููุณุชุฎุฏู ุจููุก ูููุฐุฌ ุงูุชุณุฌูู (ุงูุงุณูุ ุงูุจุฑูุฏุ ูููุฉ ุงููุฑูุฑุ ุงูููุน).
2. ูุฑุณู ุงูู Frontend ุทูุจุงู ุฅูู `POST /api/auth/register`.
3. ูููู ุงูู Backend ุจู:
    - ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช (Validation).
    - ุงูุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุงูุจุฑูุฏ ูุณุจูุงู.
    - ุชุดููุฑ ูููุฉ ุงููุฑูุฑ.
    - ุฅูุดุงุก ุณุฌู ุงููุณุชุฎุฏู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุน `is_verified = false`.
    - ุชูููุฏ ููุฏ ุชุญูู ุนุดูุงุฆู (ูุซูุงู 6 ุฃุฑูุงู).
    - ุฅุฑุณุงู ุงูููุฏ ุฅูู ุจุฑูุฏ ุงููุณุชุฎุฏู ุนุจุฑ ุฎุฏูุฉ ุงูุจุฑูุฏ.
4. ูุนูุฏ ุงูุฎุงุฏู ุงุณุชุฌุงุจุฉ ุจูุฌุงุญ ุงูุนูููุฉ.

### 2. ุงูุชุญูู (Verification)
1. ูุธูุฑ ูููุณุชุฎุฏู ูุงุฌูุฉ ูุฅุฏุฎุงู ููุฏ ุงูุชุญูู.
2. ูุฑุณู ุงููุณุชุฎุฏู ุงูููุฏ ุฅูู `POST /api/auth/verify`.
3. ูููู ุงูู Backend ุจู:
    - ุงูุจุญุซ ุนู ุงููุณุชุฎุฏู ุนุจุฑ ุงูุจุฑูุฏ.
    - ูุทุงุจูุฉ ุงูููุฏ ุงููุฏุฎู ูุน ุงูููุฏ ุงููุญููุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.
    - ุงูุชุญูู ูู ุตูุงุญูุฉ ุงูููุฏ (ููุช ุงูุงูุชูุงุก).
4. ูู ุญุงู ุตุญุฉ ุงูููุฏ:
    - ูุชู ุชุญุฏูุซ ุญุงูุฉ ุงููุณุชุฎุฏู ุฅูู `is_verified = true`.
    - ูุชู ูุณุญ ููุฏ ุงูุชุญูู.
    - (ุงุฎุชูุงุฑู) ูุชู ุฅูุดุงุก ุชููู JWT ูุชุณุฌูู ุฏุฎูู ุงููุณุชุฎุฏู ูุจุงุดุฑุฉ.

### 3. ุชุณุฌูู ุงูุฏุฎูู (Login)
1. ูุฏุฎู ุงููุณุชุฎุฏู ุงูุจุฑูุฏ ููููุฉ ุงููุฑูุฑ.
2. ูุฑุณู ุงูุทูุจ ุฅูู `POST /api/auth/login`.
3. ูููู ุงูู Backend ุจู:
    - ุงูุจุญุซ ุนู ุงููุณุชุฎุฏู.
    - ุงูุชุญูู ูู ุชุทุงุจู ูููุฉ ุงููุฑูุฑ ุงููุดูุฑุฉ.
    - ุงูุชุญูู ูู ุฃู ุงูุญุณุงุจ ููุนู (`is_verified = true`).
4. ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ุตุญูุญุฉ:
    - ูุชู ุฅูุดุงุก **Access Token (JWT)** ูุญุชูู ุนูู ุจูุงูุงุช ุงููุณุชุฎุฏู (ID, Role).
    - ูุชู ุฅุฑุณุงู ุงูุชููู ุฅูู ุงูุนููู.

### 4. ุงููุตูู ููููุงุฑุฏ ุงููุญููุฉ (Protected Access)
1. ูููู ุงูู Frontend ุจุชุฎุฒูู ุงูุชููู (ูู LocalStorage ุฃู Cookie).
2. ุนูุฏ ุทูุจ ุฃู ููุฑุฏ ูุญูู (ูุซู `/api/auth/profile`):
    - ูุชู ุฅุฑูุงู ุงูุชููู ูู ุชุฑููุณุฉ ุงูุทูุจ: `Authorization: Bearer <TOKEN>`.
3. ูููู ุงูู Middleware ูู ุงูู Backend ุจู:
    - ุงูุชุญูู ูู ุตุญุฉ ุงูุชููู ูุชูููุนู.
    - ุฅุฐุง ูุงู ุตุงูุญุงูุ ูุณูุญ ุจูุฑูุฑ ุงูุทูุจ.
    - ุฅุฐุง ูุงู ุบูุฑ ุตุงูุญ ุฃู ููุชููุ ูุนูุฏ ุฎุทุฃ `401 Unauthorized`.

---

## โฑ๏ธ ุณูุงุณุงุช ุงูุฃูุงู
- **ุตูุงุญูุฉ ุงูุชููู:** ููุถู ุฃู ุชููู ูุตูุฑุฉ (ูุซูุงู ุณุงุนุฉ ุฃู ููู) ูุฒูุงุฏุฉ ุงูุฃูุงู.
- **ุฃููุงุฏ ุงูุชุญูู:** ุตุงูุญุฉ ููุชุฑุฉ ูุตูุฑุฉ (ูุซูุงู 15 ุฏูููุฉ) ูุชุณุชุฎุฏู ููุฑุฉ ูุงุญุฏุฉ.
- **Rate Limiting:** ูุชู ุชุทุจูู ุญุฏ ูุนุฏุฏ ูุญุงููุงุช ุงูุฏุฎูู ูุงูุชุญูู ูููุน ูุฌูุงุช ุงูุชุฎููู (Brute Force).
